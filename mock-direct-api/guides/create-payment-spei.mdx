---
title: "Create SPEI Payment"
sidebarTitle: "SPEI Payment"
description: "Generate bank transfer payment instructions for customers"
---

# Create a SPEI Payment

This guide shows you how to create SPEI (Sistema de Pagos Electrónicos Interbancarios) bank transfer payments using Tonder's Direct API. SPEI is Mexico's real-time interbank transfer system, offering a secure alternative to card payments.

## Overview

SPEI payments allow customers to pay via bank transfer from any Mexican bank. You generate payment instructions with a unique CLABE number, and your customer initiates the transfer through their bank's app or website.

<Info>
**When to Use SPEI:**
- Customers who prefer bank transfers over cards
- Large transaction amounts
- B2B payments
- Customers concerned about online card security
- Businesses looking to reduce card processing fees
</Info>

## Step 1: Create the Payment Request

SPEI payments require minimal information - just the basic transaction details:

```json
{
  "operation_type": "payment",
  "amount": 500.00,
  "currency": "MXN",
  "customer": {
    "name": "Carlos Eduardo López",
    "email": "carlos.lopez@empresa.mx"
  },
  "payment_method": {
    "type": "SPEI"
  },
  "client_reference": "invoice-456"
}
```

### Required Fields

| Field | Type | Description |
|-------|------|-------------|
| `operation_type` | string | Must be `"payment"` |
| `amount` | decimal | Payment amount (typically min: $10 MXN) |
| `currency` | string | Must be `"MXN"` |
| `customer` | object | Customer information with `name` and `email` |
| `payment_method.type` | string | Must be `"SPEI"` for bank transfers |
| `client_reference` | string | Your unique transaction identifier |

## Step 2: Send the Request

Make a POST request to create the SPEI payment instructions:

```bash cURL
curl -X POST https://stage.tonder.io/api/v1/process/ \
  -H "Authorization: Token YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "operation_type": "payment",
    "amount": 500.00,
    "currency": "MXN",
    "customer": {
      "name": "Carlos Eduardo López",
      "email": "carlos.lopez@empresa.mx"
    },
    "payment_method": {
      "type": "SPEI"
    },
    "client_reference": "invoice-456"
  }'
```

<CodeGroup>
```python Python
import requests

url = "https://stage.tonder.io/api/v1/process/"
headers = {
    "Authorization": "Token YOUR_API_KEY",
    "Content-Type": "application/json"
}

payload = {
    "operation_type": "payment",
    "amount": 500.00,
    "currency": "MXN",
    "customer": {
        "name": "Carlos Eduardo López",
        "email": "carlos.lopez@empresa.mx"
    },
    "payment_method": {
        "type": "SPEI"
    },
    "client_reference": "invoice-456"
}

response = requests.post(url, headers=headers, json=payload)
result = response.json()
print(f"CLABE: {result['payment_instructions']['clabe']}")
```

```javascript JavaScript
const response = await fetch('https://stage.tonder.io/api/v1/process/', {
  method: 'POST',
  headers: {
    'Authorization': 'Token YOUR_API_KEY',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    operation_type: 'payment',
    amount: 500.00,
    currency: 'MXN',
    customer: {
      name: 'Carlos Eduardo López',
      email: 'carlos.lopez@empresa.mx'
    },
    payment_method: {
      type: 'SPEI'
    },
    client_reference: 'invoice-456'
  })
});

const data = await response.json();
console.log('CLABE:', data.payment_instructions.clabe);
```
</CodeGroup>

## Step 3: Handle the Response

SPEI payments return with `pending` status and include payment instructions:

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440001",
  "operation_type": "payment",
  "status": "pending",
  "amount": 500.00,
  "currency": "MXN",
  "payment_id": 12346,
  "transaction_id": "txn_spei456",
  "created_at": "2024-07-26T10:35:00Z",
  "payment_instructions": {
    "clabe": "646180157000000004",
    "bank_name": "STP",
    "beneficiary_name": "TU NEGOCIO SA DE CV",
    "reference": "7812345678",
    "amount": 500.00,
    "expires_at": "2024-07-27T10:35:00Z"
  }
}
```

### Response Fields

| Field | Description |
|-------|-------------|
| `id` | Unique transaction identifier for status tracking |
| `status` | Initial status will be `pending` |
| `payment_instructions.clabe` | CLABE number for bank transfer (18 digits) |
| `payment_instructions.bank_name` | Receiving bank name |
| `payment_instructions.beneficiary_name` | Account holder name |
| `payment_instructions.reference` | Numeric reference for the transfer |
| `payment_instructions.expires_at` | Expiration date (typically 24 hours) |

<Warning>
**Important:** The CLABE number is unique to each transaction. Customers must use this exact CLABE to ensure payment is correctly attributed to their order.
</Warning>

## Step 4: Display Payment Instructions to Customer

Provide clear, detailed instructions to help customers complete their bank transfer:

<Steps>
  <Step title="Show the CLABE Number">
    Display the 18-digit CLABE prominently and make it easy to copy
  </Step>
  
  <Step title="Include Bank Details">
    Show the beneficiary name and bank name
  </Step>
  
  <Step title="Display the Amount">
    Clearly show the exact amount to transfer
  </Step>
  
  <Step title="Provide the Reference">
    Include the numeric reference if required by the bank
  </Step>
  
  <Step title="Show Expiration">
    Make customers aware of the payment deadline
  </Step>
</Steps>

### Example Payment Instructions Display

```html
<div class="spei-instructions">
  <h2>Instrucciones para Transferencia SPEI</h2>
  
  <div class="transfer-details">
    <div class="detail-row">
      <label>CLABE:</label>
      <div class="clabe-value">
        <span>646180157000000004</span>
        <button onclick="copyToClipboard('646180157000000004')">Copiar</button>
      </div>
    </div>
    
    <div class="detail-row">
      <label>Banco:</label>
      <span>STP</span>
    </div>
    
    <div class="detail-row">
      <label>Beneficiario:</label>
      <span>TU NEGOCIO SA DE CV</span>
    </div>
    
    <div class="detail-row">
      <label>Monto:</label>
      <span class="amount">$500.00 MXN</span>
    </div>
    
    <div class="detail-row">
      <label>Referencia:</label>
      <span>7812345678</span>
    </div>
  </div>
  
  <div class="instructions">
    <h3>Cómo pagar:</h3>
    <ol>
      <li>Ingresa a tu banca en línea o app móvil</li>
      <li>Selecciona "Transferencia SPEI" o "Transferencia a otros bancos"</li>
      <li>Ingresa la CLABE: <strong>646180157000000004</strong></li>
      <li>Verifica el beneficiario: TU NEGOCIO SA DE CV</li>
      <li>Ingresa el monto exacto: <strong>$500.00 MXN</strong></li>
      <li>Completa la transferencia</li>
    </ol>
  </div>
  
  <div class="expiration-warning">
    <p>⏰ Esta CLABE expira el: <strong>27 de julio, 2024 a las 10:35</strong></p>
  </div>
</div>
```

## Step 5: Track Payment Status

SPEI payments can be confirmed in real-time or take up to a few hours:

1. **`pending`** - Waiting for customer to initiate transfer
2. **`in_transit`** - Transfer has been initiated (SPEI is processing)
3. **`success`** - Funds received and confirmed

### Using Webhooks (Recommended)

Receive instant notifications when the transfer is completed:

```json Webhook Payload
{
  "event": "payment.status_changed",
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440001",
    "status": "success",
    "amount": 500.00,
    "completed_at": "2024-07-26T14:22:15Z",
    "sender_bank": "BBVA",
    "tracking_key": "AB12345678901234567"
  }
}
```

### Polling Status

Query the transaction status endpoint if you're not using webhooks:

```bash
curl -X GET https://stage.tonder.io/api/v1/transactions/550e8400-e29b-41d4-a716-446655440001/ \
  -H "Authorization: Token YOUR_API_KEY"
```

<Info>
**SPEI Processing Time:** SPEI transfers are typically processed within minutes during banking hours (Monday-Friday, 6:00-18:00 Mexico City time). Transfers outside these hours may be processed the next business day.
</Info>

## Best Practices

<AccordionGroup>
  <Accordion title="Customer Communication">
    - Send payment instructions via email immediately after order creation
    - Include step-by-step screenshots for popular banking apps
    - Provide customer support contact for payment issues
    - Send reminder emails before expiration
    - Confirm receipt of payment promptly
  </Accordion>

  <Accordion title="Order Management">
    - Set appropriate expiration times (24-48 hours recommended)
    - Keep orders in "pending payment" status until confirmed
    - Implement automatic order cancellation after expiration
    - Have a process for handling late payments
    - Allow customers to regenerate expired payment instructions
  </Accordion>

  <Accordion title="Technical Implementation">
    - Make CLABE number easy to copy (copy button)
    - Display amount in clear, large font to avoid transfer errors
    - Validate CLABE format (18 digits with checksum)
    - Use webhooks for real-time status updates
    - Handle duplicate transfers gracefully
  </Accordion>
</AccordionGroup>

## Common Scenarios

| Issue | Cause | Solution |
|-------|-------|----------|
| `wrong_amount` | Customer transferred incorrect amount | Contact customer for additional transfer or refund difference |
| `expired_clabe` | Customer tried to pay after expiration | Generate new CLABE and send updated instructions |
| `wrong_clabe` | Customer entered wrong CLABE | Provide correct CLABE and assist with new transfer |
| `delayed_confirmation` | Transfer outside banking hours | Inform customer payment will be confirmed next business day |

## Understanding CLABE Numbers

The CLABE (Clave Bancaria Estandarizada) is an 18-digit standardized banking code used for transfers in Mexico:

- **Digits 1-3:** Bank code
- **Digits 4-6:** Branch code  
- **Digits 7-17:** Account number
- **Digit 18:** Check digit

Each CLABE is unique to a transaction and includes validation to prevent errors.

## Next Steps

<CardGroup cols={2}>
  <Card title="Setup Webhooks" icon="webhook" href="/mock-direct-api/guides/setup-webhooks">
    Get real-time payment notifications
  </Card>
  <Card title="Check Status" icon="magnifying-glass" href="/mock-direct-api/guides/check-transaction-status">
    Learn how to verify payment status
  </Card>
  <Card title="OXXO Payments" icon="building" href="/mock-direct-api/guides/create-payment-oxxo">
    Explore cash payment alternative
  </Card>
  <Card title="Testing" icon="flask" href="/mock-direct-api/testing">
    Test SPEI payments in sandbox
  </Card>
</CardGroup>

## Related Resources

- [SPEI Payments Overview](/mock-direct-api/spei)
- [CLABE Validation](/reference/clabe-validation)
- [Webhooks Guide](/mock-direct-api/webhooks)
- [API Reference](/reference/process-transaction)

